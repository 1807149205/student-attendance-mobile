import{c as B,r as N,u as U,e as m,i as M,a as P,b as g,w as D,g as E,d as l,m as j,s as q,f as z,h as L,j as $,o as F,k as H,l as I,n as a,p as J,F as Y,t as u,q as x,v as d,x as h,y as Z,z as G,A as K}from"./index-CN85PQXA.js";function Q(){const e=N({show:!1}),t=o=>{e.show=o},n=o=>{m(e,o,{transitionAppear:!0}),t(!0)},s=()=>t(!1);return U({open:n,close:s,toggle:t}),{open:n,close:s,state:e,toggle:t}}function W(e){const t=B(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}const X={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let c=[],ee=!1,C=m({},X);const te=new Map;function k(e){return P(e)?e:{message:e}}function ne(){const{instance:e,unmount:t}=W({setup(){const n=g(""),{open:s,state:o,close:f,toggle:v}=Q(),y=()=>{},i=()=>l(q,j(o,{onClosed:y,"onUpdate:show":v}),null);return D(n,r=>{o.message=r}),E().render=i,{open:s,close:f,message:n}}});return e}function oe(){if(!c.length||ee){const e=ne();c.push(e)}return c[c.length-1]}function O(e={}){if(!M)return{};const t=oe(),n=k(e);return t.open(m({},C,te.get(n.type||C.type),n)),t}const V=e=>t=>O(m({type:e},k(t))),se=V("loading"),p=V("fail"),ae=e=>{c.length&&(e?(c.forEach(t=>{t.close()}),c=[]):c[0].close())},ce=""+new URL("考勤-BMRYZxDN.png",import.meta.url).href;class ie{axiosInstance;baseURL;constructor(t){this.baseURL=t,this.axiosInstance=z.create({baseURL:t,timeout:8e4,headers:{"Content-Type":"application/json"}})}handleResponse(t){const n=t.data;if(n.code!==200)throw console.log("返回结果非400",n),p(n.msg),new Error(`Request failed with code ${n.code}: ${n.msg}`);return n.data}async post(t,n){const s=await this.axiosInstance.post(t,n);return this.handleResponse(s)}setToken(t){this.axiosInstance.defaults.headers.common.token=t}getUrl(){return this.baseURL}}const b=new ie("https://server1.wzlweb.top/api/sd/mobile"),T=e=>(G("data-v-97e7c8a4"),e=e(),K(),e),le={class:"container"},de={class:"head"},re={class:"headContent"},ue=T(()=>a("img",{src:ce,style:{width:"100px"}},null,-1)),pe={style:{width:"60%"}},me={style:{"font-weight":"800"}},fe=T(()=>a("p",{style:{"font-size":"14px","font-weight":"500"}},"考勤签到",-1)),ve={class:"formContainer"},_e={style:{"padding-left":"15px","padding-right":"15px","margin-top":"15px"}},he=L({__name:"IndexView",setup(e){const t=$(),n=g(""),s=g(),o=N({studentNo:"",studentName:"",timestamp:"",attendanceId:"",attendanceAddress:""}),f=async()=>{if(!o.studentName){p("姓名不能为空");return}if(!o.studentNo){p("学号不能为空");return}se({message:"加载中...",forbidClick:!0}),o.timestamp=new Date().getTime()+"",o.attendanceId=n.value,o.attendanceAddress=t.address,await b.post("/mobile/studentAttendance/attendance",JSON.stringify(o)),ae(),O("签到成功！")},v=async()=>{s.value=await b.post(`/mobile/studentAttendance/getAttendanceDetailById?attendanceId=${n.value}`),console.log(s.value),s.value||p("考勤id错误")};return F(async()=>{n.value=H.currentRoute.value.query.attendanceId,await v()}),(y,i)=>{const r=d("van-skeleton"),S=d("van-divider"),w=d("van-field"),A=d("van-cell-group"),R=d("van-button");return h(),I("div",le,[a("div",de,[a("div",re,[ue,a("div",pe,[s.value?(h(),I(Y,{key:1},[a("p",me,u(s.value?.classInfoVO.universityName)+"- "+u(s.value?.classInfoVO.departmentName)+"- "+u(s.value?.classInfoVO.majorName)+"- "+u(s.value?.classInfoVO.className),1),fe],64)):(h(),J(r,{key:0,title:"",row:3}))])])]),l(S,{style:{margin:"0"}}),a("div",ve,[l(A,{inset:""},{default:x(()=>[l(w,{modelValue:o.studentNo,"onUpdate:modelValue":i[0]||(i[0]=_=>o.studentNo=_),label:"学号",placeholder:"请输入学号"},null,8,["modelValue"]),l(w,{modelValue:o.studentName,"onUpdate:modelValue":i[1]||(i[1]=_=>o.studentName=_),label:"姓名",placeholder:"请输入用姓名"},null,8,["modelValue"])]),_:1}),a("div",_e,[l(R,{block:"",type:"success",onClick:f},{default:x(()=>[Z("签到")]),_:1})])])])}}}),ge=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},we=ge(he,[["__scopeId","data-v-97e7c8a4"]]);export{we as default};
